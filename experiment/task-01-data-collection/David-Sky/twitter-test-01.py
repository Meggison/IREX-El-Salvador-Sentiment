from apify_client import ApifyClient
import pandas as pd

# An interactive experiment to use Apify to read Tweets
# https://apify.com/quacker/twitter-scraper/api/client/python

# I have included a few sample rows in the sample_list for processing and testing
# set the variable use_cache to False to call Apify
#

# One function to add details from one tweet to an existing df
def tweet_to_df(df, tweet_dict):
    items_to_collect = df.columns.tolist()
    new_row = len(df)
    # new_row = df.iloc[0:1].copy()
    for key, value in tweet_dict.items():
        if key in items_to_collect:
            print(key, ":", value)
            df.loc[new_row, key] = value
    # df._append(new_row, ignore_index=True)
    return df

# For testing so that we don't use up Apify credits, here is a sample list
sample_list = [
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1777722104395313337', 'conversation_id': '1777722104395313337', 'full_text': 'Un nuevo dia en la Comisi√≥n de Derechos Humanos y libertad de expresi√≥n, el trabajo duro contin√∫a. Cada paso que damos nos acerca m√°s a una sociedad justa y equitativa para todos. ¬°Seguimos adelante con determinaci√≥n y compromiso! üí™ #DerechosHumanos #TrabajoDuro #compromiso https://t.co/7TXCrMCsyV', 'reply_count': 37, 'retweet_count': 488, 'favorite_count': 1713, 'hashtags': ['DerechosHumanos', 'TrabajoDuro', 'compromiso'], 'symbols': [], 'user_mentions': [], 'urls': [], 'media': [{'media_url': 'https://pbs.twimg.com/amplify_video_thumb/1777721969925881856/img/_dKXXWX3l-48r1eT.jpg', 'type': 'video', 'video_url': 'https://video.twimg.com/amplify_video/1777721969925881856/vid/avc1/720x1280/EKl3yCBUKBavVHRl.mp4?tag=14'}], 'url': 'https://twitter.com/andresguzm/status/1777722104395313337', 'created_at': '2024-04-09T15:35:52.000Z', '#sort_index': '1783961839328034816', 'view_count': 205105, 'quote_count': 9, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1727067358349414796', 'conversation_id': '1727067358349414796', 'full_text': 'Ser√° que la inteligencia artificial, terminar√° con los peritos o expertos en el proceso judicial ? #ai #Justicia https://t.co/2xjVEUHdQh', 'reply_count': 1, 'retweet_count': 138, 'favorite_count': 402, 'hashtags': ['ai', 'Justicia'], 'symbols': [], 'user_mentions': [], 'urls': [{'url': 'https://t.co/2xjVEUHdQh', 'expanded_url': 'https://youtu.be/nRs-N8dNBbk?si=zsVgwSKI03qe3Q2Z', 'display_url': 'youtu.be/nRs-N8dNBbk?si‚Ä¶'}], 'media': [], 'url': 'https://twitter.com/andresguzm/status/1727067358349414796', 'created_at': '2023-11-21T20:52:00.000Z', '#sort_index': '1783961839328034815', 'view_count': 349252, 'quote_count': 8, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1743277817154916369', 'conversation_id': '1743277817154916369', 'full_text': 'Me piden muchas veces... un ejemplo de como la IA puede afectar el proceso de selecci√≥n de empleados en una.En la era digital, el proceso de selecci√≥n de empleados est√° experimentando una transformaci√≥n radical gracias a la inteligencia artificial. üåê‚ú®. Explico con un üßµ https://t.co/6XLWdd4Jg9', 'reply_count': 1, 'retweet_count': 15, 'favorite_count': 300, 'hashtags': [], 'symbols': [], 'user_mentions': [], 'urls': [], 'media': [{'media_url': 'https://pbs.twimg.com/media/GDFd7goWYAEz0hj.jpg', 'type': 'photo'}], 'url': 'https://twitter.com/andresguzm/status/1743277817154916369', 'created_at': '2024-01-05T14:26:34.000Z', '#sort_index': '1783961839328034814', 'view_count': 12822, 'quote_count': 1, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1742200593957974395', 'conversation_id': '1742200593957974395', 'full_text': '¬øRecuerdas cu√°ndo te uniste a X? ¬°Yo s√≠! #MiAniversarioDeX https://t.co/oKBCCHefYb', 'reply_count': 0, 'retweet_count': 0, 'favorite_count': 3, 'hashtags': ['MiAniversarioDeX'], 'symbols': [], 'user_mentions': [], 'urls': [], 'media': [{'media_url': 'https://pbs.twimg.com/media/GC2KNTYXcAAwh3t.jpg', 'type': 'photo'}], 'url': 'https://twitter.com/andresguzm/status/1742200593957974395', 'created_at': '2024-01-02T15:06:04.000Z', '#sort_index': '1783961839328034813', 'view_count': 198, 'quote_count': 0, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1760607082376519973', 'conversation_id': '1760607082376519973', 'full_text': 'La seguridad de la sociedad y el respeto de los DDHH del pueblo son el sentido, el ser del Estado,  nunca se nos puede desenfocar del verdadero objetivo!! https://t.co/KX7kJv8vlB', 'reply_count': 1, 'retweet_count': 23, 'favorite_count': 180, 'hashtags': [], 'symbols': [], 'user_mentions': [], 'urls': [], 'media': [{'media_url': 'https://pbs.twimg.com/ext_tw_video_thumb/1760606895377616897/pu/img/C18MqEvKofn0hsy2.jpg', 'type': 'video', 'video_url': 'https://video.twimg.com/ext_tw_video/1760606895377616897/pu/vid/avc1/720x960/JDUMMdOi9ku2PmaP.mp4?tag=12'}], 'url': 'https://twitter.com/andresguzm/status/1760607082376519973', 'created_at': '2024-02-22T10:06:53.000Z', '#sort_index': '1783961839328034812', 'view_count': 17106, 'quote_count': 12, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1769337928327614558', 'conversation_id': '1769337928327614558', 'full_text': 'Recordar el pasado nos ayuda a valorar el presente, cada d√≠a es un nuevo comienzo lleno de esperanza gracias al presidente @nayibbukele #DDHH https://t.co/08qkJjui4t', 'reply_count': 0, 'retweet_count': 4, 'favorite_count': 104, 'hashtags': ['DDHH'], 'symbols': [], 'user_mentions': [{'id_str': '20736511', 'name': 'Nayib Bukele', 'screen_name': 'nayibbukele', 'profile': 'https://twitter.com/nayibbukele'}], 'urls': [], 'media': [{'media_url': 'https://pbs.twimg.com/ext_tw_video_thumb/1769337820202618880/pu/img/Tpgl1YlxUdG_9WWm.jpg', 'type': 'video', 'video_url': 'https://video.twimg.com/ext_tw_video/1769337820202618880/pu/vid/avc1/848x480/8h2kOw_pDOxGoIKR.mp4?tag=12'}], 'url': 'https://twitter.com/andresguzm/status/1769337928327614558', 'created_at': '2024-03-17T12:20:09.000Z', '#sort_index': '1783961839328034811', 'view_count': 2020, 'quote_count': 0, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1715037729421938783', 'conversation_id': '1715037729421938783', 'full_text': '12 s√≠ntomas para detectar ojo si tienes alguno ve al m√©dico !!!! Abrazo #CancerDuSein #cancerDeMama  https://t.co/P9iuPhl7sc', 'reply_count': 0, 'retweet_count': 18, 'favorite_count': 102, 'hashtags': ['CancerDuSein', 'cancerDeMama'], 'symbols': [], 'user_mentions': [], 'urls': [{'url': 'https://t.co/P9iuPhl7sc', 'expanded_url': 'https://youtu.be/5pk11p8vZEY?si=riU1Mq34X8MJMGX0', 'display_url': 'youtu.be/5pk11p8vZEY?si‚Ä¶'}], 'media': [], 'url': 'https://twitter.com/andresguzm/status/1715037729421938783', 'created_at': '2023-10-19T16:10:33.000Z', '#sort_index': '1783961839328034810', 'view_count': 47376, 'quote_count': 0, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1682728543069896705', 'conversation_id': '1682728543069896705', 'full_text': 'Me resulta llamativo el hecho de que la CIDH y muchas ONG no centren su trabajo en ayudar a construir confianza social e integrar mesas de trabajo permanentes de ayuda a las v√≠ctimas de las pandillas: mujeres, ni√±os y familias enteras que a√∫n tienen miedo. La ayuda psicol√≥gica despu√©s de un trauma de tal magnitud es vital; el trabajo en recuperar la confianza debe ser la prioridad frente a aquellos despojados, amedrentados y a√∫n muy asustados ciudadanos. Necesitamos que los organismos de derechos humanos internacionales construyan y apoyen a los Estados, para eso fueron creados, no para recriminar basados en publicaciones en redes sociales.... @nayibbukele', 'reply_count': 54, 'retweet_count': 15, 'favorite_count': 60, 'hashtags': [], 'symbols': [], 'user_mentions': [], 'urls': [], 'media': [], 'url': 'https://twitter.com/andresguzm/status/1682728543069896705', 'created_at': '2023-07-22T12:25:22.000Z', '#sort_index': '1783961839328034809', 'view_count': 63961, 'quote_count': 38, 'is_quote_tweet': True, 'is_retweet': False, 'is_pinned': False, 'is_truncated': True, 'quoted_tweet': {'user': {'created_at': '2008-12-12T16:25:25.000Z', 'default_profile_image': False, 'description': 'Ent√©rese de las noticias m√°s importantes de Colombia y el mundo en nuestro timeline y p√°gina web.', 'fast_followers_count': 0, 'favourites_count': 2184, 'followers_count': 5568429, 'friends_count': 40, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 10859, 'location': 'Colombia', 'media_count': 166046, 'name': 'Revista Semana', 'normal_followers_count': 5568429, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/18079284/1698326574', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1229471444394029061/AUEHUy1y_normal.jpg', 'screen_name': 'RevistaSemana', 'statuses_count': 725801, 'translator_type': 'regular', 'url': 'https://t.co/Tu9l22YGnO', 'verified': True, 'withheld_in_countries': [], 'id_str': '18079284'}, 'id': '1682723415092871169', 'conversation_id': '1682723415092871169', 'full_text': '#Mundo | Andr√©s Guzm√°n, el colombiano que trabaja para Nayib Bukele, revela c√≥mo es trabajar con el presidente de El Salvador y habla de sus compatriotas presos en ese pa√≠s\nhttps://t.co/MIav04hkDw', 'reply_count': 30, 'retweet_count': 101, 'favorite_count': 258, 'hashtags': ['Mundo'], 'symbols': [], 'user_mentions': [], 'urls': [{'url': 'https://t.co/MIav04hkDw', 'expanded_url': 'https://www.semana.com/mundo/articulo/andres-guzman-el-colombiano-que-trabaja-para-nayib-bukele-revela-como-es-trabajar-con-el-presidente-de-el-salvador-y-habla-de-sus-compatriotas-presos-en-ese-pais/202345/', 'display_url': 'semana.com/mundo/articulo‚Ä¶'}], 'media': [], 'url': 'https://twitter.com/RevistaSemana/status/1682723415092871169', 'created_at': '2023-07-22T12:05:00.000Z', '#sort_index': '1783961839328034800', 'view_count': 48355, 'quote_count': 6, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False}, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1743328759866851688', 'conversation_id': '1743328759866851688', 'full_text': 'Es importanrtante tener un  consciente colectivo para que las v√≠ctimas de los grupos terroristas denuncien sus casos ante las instituciones correspondientes y que los il√≠citos no queden en la impunidad. #terroristas #elsalvador  .https://t.co/mSzhGsdAcy', 'reply_count': 0, 'retweet_count': 0, 'favorite_count': 2, 'hashtags': ['terroristas', 'elsalvador'], 'symbols': [], 'user_mentions': [], 'urls': [{'url': 'https://t.co/mSzhGsdAcy', 'expanded_url': 'https://diarioelsalvador.com/comision-de-derechos-humanos-insta-a-victimas-de-pandillas-a-denunciar/407160/', 'display_url': 'diarioelsalvador.com/comision-de-de‚Ä¶'}], 'media': [], 'url': 'https://twitter.com/andresguzm/status/1743328759866851688', 'created_at': '2024-01-05T17:49:00.000Z', '#sort_index': '1783961839328034808', 'view_count': 335, 'quote_count': 0, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
{'user': {'created_at': '2010-01-02T14:56:49.000Z', 'default_profile_image': False, 'description': 'Comisionado para los DDHH, y libertad de expresi√≥n El Salvador, profesor, protecci√≥n de datos, IA y DDHH consultor y cocinero ... apasionado !!', 'fast_followers_count': 0, 'favourites_count': 322, 'followers_count': 2205, 'friends_count': 1346, 'has_custom_timelines': True, 'is_translator': False, 'listed_count': 3, 'location': 'El Salvador', 'media_count': 57, 'name': 'Andr√©s GUZMAN C', 'normal_followers_count': 2205, 'possibly_sensitive': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/101240523/1692826803', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/1758268224498454528/XxZzze7P_normal.jpg', 'screen_name': 'andresguzm', 'statuses_count': 671, 'translator_type': 'none', 'verified': True, 'withheld_in_countries': [], 'id_str': '101240523'}, 'id': '1599405529486409730', 'conversation_id': '1599405529486409730', 'full_text': 'Ser de la izquierda es, como ser de la derecha, una de las infinitas maneras que el hombre puede elegir para ser un imb√©cil: ambas, en efecto, son formas de la hemiplej√≠a moral. Ortega y Gasset', 'reply_count': 2, 'retweet_count': 7, 'favorite_count': 30, 'hashtags': [], 'symbols': [], 'user_mentions': [], 'urls': [], 'media': [], 'url': 'https://twitter.com/andresguzm/status/1599405529486409730', 'created_at': '2022-12-04T14:09:28.000Z', '#sort_index': '1783961839328034807', 'quote_count': 2, 'is_quote_tweet': False, 'is_retweet': False, 'is_pinned': False, 'is_truncated': False, 'startUrl': 'https://twitter.com/andresguzm/with_replies'},
]
use_cache=False

twitter_handle="FGR_SV"
local_csv   = f"/Users/davidsky/PycharmProjectselsalvador-local/twitter-{twitter_handle}.csv"
local_excel = f"/Users/davidsky/PycharmProjectselsalvador-local/twitter-{twitter_handle}.xlsx"


# Defines the values we will save
# 2024-05-13 - add reply_count and is_retweet
df=pd.DataFrame(columns=[
                         "url",
                         "created_at",
                         "id",
                         "conversation_id",
                         "is_retweet",
                         "retweet_count",
                         "favorite_count",
                         "reply_count",
                         "full_text"
                         ])
# df.loc[0] = ['test key', 'test_value']

# For testing, use the cache if specified
if use_cache == True:
    for one_tweet_dict in sample_list:
        df=tweet_to_df(df, one_tweet_dict)
else:
    print("You will need your Apify personal token - log in to the Console, then \n\tSettings then \n\t\tIntegration - copy button for Personal API tokens\n")
    your_api_token = input("Enter your personal Apify token - or enter to quit")
    # at least more than 40 characters
    if len(your_api_token) < 2:
        print("Quiting\n")
    elif len(your_api_token) < 40:
        print(f"Quiting now - token seems too short - only {len(your_api_token)} characters")
    else:
        print("Token seems long enough, attempting to initialize with the token")


    # Otherwise - Initialize the ApifyClient with your Apify API token
    try:
        client = ApifyClient(your_api_token)
    except:
        print("Unable to connect")

    print("\n\nConnected OK\n\n")

    # Prepare the Actor input
    run_input = {
        "handles": [twitter_handle],
        "tweetsDesired": 75,
        "addUserInfo": True,
        "startUrls": [],
        "proxyConfig": { "useApifyProxy": True },
    }

    # Run the Actor and wait for it to finish
    run = client.actor("u6ppkMWAx2E2MpEuF").call(run_input=run_input)

    # Fetch and print Actor results from the run's dataset (if there are any)
    for one_tweet_dict in client.dataset(run["defaultDatasetId"]).iterate_items():
        df=tweet_to_df(df, one_tweet_dict)


# Either way we now have a df

# Write locally for now
df.to_csv(local_csv, index=False)
df.to_excel(local_excel)
print(f"\nDone! Wrote {len(df)} tweets to:\n\t {local_csv} and\n\t{local_excel}")

